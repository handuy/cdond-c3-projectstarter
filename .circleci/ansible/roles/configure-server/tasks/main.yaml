- name: Update/upgrade packages
  become: true
  become_method: sudo
  become_user: root  
  apt:
    update_cache: yes
    
- name: Install nodejs, npm, and pm2.
  become: true
  become_method: sudo
  become_user: root 
  ansible.builtin.command: "{{ item }}"
  with_items:
    - curl -s https://deb.nodesource.com/gpgkey/nodesource.gpg.key | apt-key add -
    - sh -c "echo deb https://deb.nodesource.com/node_12.x bionic main > /etc/apt/sources.list.d/nodesource.list"
    - apt-get update
    - apt-get install nodejs
    - node -v
    - npm install pm2 -g